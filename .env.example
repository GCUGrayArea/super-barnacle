# SkyFi MCP Server Environment Configuration
# Copy this file to .env and fill in your actual values
#
# Quick Start:
# 1. cp .env.example .env
# 2. Edit .env and replace placeholder values
# 3. Set SKYFI_API_KEY (required)
# 4. Set OPENAI_API_KEY (required for demo agent)
# 5. Configure DATABASE_URL or individual POSTGRES_* variables

# ============================================================================
# Server Configuration
# ============================================================================

# Environment: development, staging, production
NODE_ENV=development

# Port for MCP server to listen on
PORT=3000

# Logging level: debug, info, warn, error
LOG_LEVEL=debug

# ============================================================================
# MCP Server Configuration
# ============================================================================

# MCP server name (displayed in MCP tools list)
MCP_SERVER_NAME=skyfi-mcp

# MCP server version
MCP_SERVER_VERSION=1.0.0

# SSE endpoint path
SSE_ENDPOINT=/sse

# Message endpoint path
MESSAGE_ENDPOINT=/message

# Health check endpoint path
HEALTH_ENDPOINT=/health

# ============================================================================
# SkyFi API Configuration
# ============================================================================

# Required: Your SkyFi API key (obtain from https://www.skyfi.com/developers)
# Example: sk_live_1234567890abcdef
SKYFI_API_KEY=your_skyfi_api_key_here

# Optional: SkyFi API base URL (defaults to production)
SKYFI_API_BASE_URL=https://api.skyfi.com/v1

# Optional: Request timeout in milliseconds
SKYFI_API_TIMEOUT=30000

# Optional: Max retry attempts for failed requests
SKYFI_MAX_RETRIES=3

# ============================================================================
# OpenAI Configuration (for demo agent)
# ============================================================================

# Required for demo agent: Your OpenAI API key
# Example: sk-proj-1234567890abcdef
OPENAI_API_KEY=your_openai_api_key_here

# Optional: OpenAI model to use
OPENAI_MODEL=gpt-4

# Optional: Max tokens for completion
OPENAI_MAX_TOKENS=4000

# Optional: Temperature (0.0-2.0)
OPENAI_TEMPERATURE=0.7

# ============================================================================
# Database Configuration (PostgreSQL for caching)
# ============================================================================

# Option 1: Use connection URL (recommended)
# Format: postgresql://user:password@host:port/database
# Example: postgresql://postgres:mypassword@localhost:5432/skyfi_mcp
DATABASE_URL=postgresql://postgres:skyfi_dev_password@localhost:5432/skyfi_mcp

# Option 2: Use individual connection parameters (if DATABASE_URL not set)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=skyfi_mcp
POSTGRES_USER=postgres
POSTGRES_PASSWORD=skyfi_dev_password

# Connection pool settings
POSTGRES_MAX_CONNECTIONS=10
POSTGRES_IDLE_TIMEOUT=30000
POSTGRES_CONNECTION_TIMEOUT=2000

# SSL configuration (true or false)
POSTGRES_SSL=false

# ============================================================================
# Database Migration Configuration
# ============================================================================
# These are used by the migration CLI (npm run migrate:*)
# If not set, falls back to POSTGRES_* or DATABASE_URL

DB_HOST=localhost
DB_PORT=5432
DB_NAME=skyfi_mcp
DB_USER=postgres
DB_PASSWORD=skyfi_dev_password
DB_POOL_MAX=10
DB_IDLE_TIMEOUT=30000
DB_CONNECT_TIMEOUT=2000
DB_SSL=false

# ============================================================================
# Cache Configuration
# ============================================================================

# Enable/disable caching layer
ENABLE_CACHE=true

# Cache TTL for archive searches (hours)
CACHE_TTL_HOURS=24

# Cache TTL for feasibility checks (hours)
FEASIBILITY_CACHE_TTL_HOURS=24

# ============================================================================
# Rate Limiting
# ============================================================================

# Maximum requests per window
RATE_LIMIT_MAX_REQUESTS=100

# Time window in milliseconds (60000 = 1 minute)
RATE_LIMIT_WINDOW_MS=60000

# ============================================================================
# CloudWatch Metrics (AWS - Optional)
# ============================================================================

# Enable CloudWatch metrics publishing
CLOUDWATCH_ENABLED=false

# AWS region for CloudWatch
AWS_REGION=us-east-1

# CloudWatch namespace for metrics
CLOUDWATCH_NAMESPACE=SkyFiMCP

# Optional: AWS credentials (if not using IAM role)
# AWS_ACCESS_KEY_ID=your_access_key
# AWS_SECRET_ACCESS_KEY=your_secret_key

# ============================================================================
# Health Check Configuration
# ============================================================================

# Enable deep health checks (includes SkyFi API connectivity)
HEALTH_CHECK_DEEP=true

# Health check timeout in milliseconds
HEALTH_CHECK_TIMEOUT=5000

# Include metrics in health check response
HEALTH_CHECK_INCLUDE_METRICS=true

# ============================================================================
# Demo Agent Configuration
# ============================================================================

# Enable demo agent CLI
ENABLE_DEMO_AGENT=true

# Maximum tool call iterations per user message
MAX_TOOL_ITERATIONS=5

# Enable verbose logging for demo agent
AGENT_VERBOSE=false

# ============================================================================
# Development Tools (Docker Compose)
# ============================================================================

# pgAdmin configuration (for database management UI)
PGADMIN_EMAIL=admin@skyfi.local
PGADMIN_PASSWORD=admin
PGADMIN_PORT=5050

# ============================================================================
# Security & Secrets (Production)
# ============================================================================

# For production deployments, use AWS Secrets Manager, HashiCorp Vault,
# or your platform's secret management instead of .env files.

# Example AWS Secrets Manager ARNs (reference these in ECS task definitions):
# SKYFI_API_KEY_SECRET_ARN=arn:aws:secretsmanager:us-east-1:123456789:secret:skyfi-api-key
# DATABASE_URL_SECRET_ARN=arn:aws:secretsmanager:us-east-1:123456789:secret:database-url
# OPENAI_API_KEY_SECRET_ARN=arn:aws:secretsmanager:us-east-1:123456789:secret:openai-api-key

# ============================================================================
# Testing Configuration
# ============================================================================

# Enable integration tests against real API (use with caution)
TEST_AGAINST_REAL_API=false

# Test SkyFi API key (separate from production)
# TEST_SKYFI_API_KEY=sk_test_1234567890abcdef

# ============================================================================
# Additional Optional Configuration
# ============================================================================

# CORS allowed origins (comma-separated)
# CORS_ORIGINS=http://localhost:3000,https://app.example.com

# Request body size limit
# BODY_LIMIT=10mb

# Enable request logging
# REQUEST_LOGGING=true

# Timezone for logs (default: UTC)
# TZ=America/New_York
